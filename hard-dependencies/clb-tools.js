!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.clbTools=e():t.clbTools=e()}(self,(function(){return(()=>{var t={406:(t,e,i)=>{!function(e){t.exports=function(t,e){"use strict";var i,n,r=t.document;"atob"in t&&"btoa"in t||(i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],t.btoa||(t.btoa=function(t){for(var e,n,r,s=t.length,a=0,o="";a<s;){if(e=255&t.charCodeAt(a++),a==s){o+=i.charAt(e>>2),o+=i.charAt((3&e)<<4),o+="==";break}if(n=t.charCodeAt(a++),a==s){o+=i.charAt(e>>2),o+=i.charAt((3&e)<<4|(240&n)>>4),o+=i.charAt((15&n)<<2),o+="=";break}r=t.charCodeAt(a++),o+=i.charAt(e>>2),o+=i.charAt((3&e)<<4|(240&n)>>4),o+=i.charAt((15&n)<<2|(192&r)>>6),o+=i.charAt(63&r)}return o}),t.atob||(t.atob=function(t){for(var e,i,r,s,a=t.length,o=0,h="";o<a;){for(;e=n[255&t.charCodeAt(o++)],o<a&&-1==e;);if(-1==e)break;for(;i=n[255&t.charCodeAt(o++)],o<a&&-1==i;);if(-1==i)break;h+=String.fromCharCode(e<<2|(48&i)>>4);do{if(61==(r=255&t.charCodeAt(o++)))return h}while(r=n[r],o<a&&-1==r);if(-1==r)break;h+=String.fromCharCode((15&i)<<4|(60&r)>>2);do{if(61==(s=255&t.charCodeAt(o++)))return h}while(s=n[s],o<a&&-1==s);if(-1==s)break;h+=String.fromCharCode((3&r)<<6|s)}return h}));var s=t.Promise||function(t){this.then=t};function a(t,e){return e&&t instanceof e}function o(t){for(var e=1,i=arguments.length;e<i;++e){var n,r=arguments[e];for(n in r)void 0!==r[n]&&(t[n]=r[n])}return t}function h(t){return arguments[0]=l(t),o.apply(null,arguments)}function f(t,e,i){return a(i,Function)?i.call(t,e.contexts[0]):i}function u(t){return function(){var e=arguments,i=e.length-1,n=t.length-1,r=e[i];if(e.length=1+n,!a(r,Function)){var o=this;return new s((function(i,r){e[n]=function(t,e){return t?r(t):i(e)},t.apply(o,e)}))}e[i]=void 0,e[n]=r,t.apply(this,e)}}function c(t,i){return a(t,c)?t.as(i):(a(t,e)||(t=new e(t,void 0,void 0,i?i["jBinary.littleEndian"]:void 0)),a(this,c)?(this.view=t,this.view.seek(0),this.contexts=[],this.as(i,!0)):new c(t,i))}var l=(l=Object.create)||function(t){function e(){}return e.prototype=t,new e},y=c.prototype,p=y.typeSet={};y.toValue=function(t){return f(this,this,t)},y._named=function(t,e,i){return t.displayName=e+" @ "+(void 0!==i?i:this.view.tell()),t};var d=Object.defineProperty;if(d)try{d({},"x",{})}catch(u){d=void 0}else d=function(t,e,i,n){n&&(t[e]=i.value)};var g,b="jBinary.Cache",v=0;function w(t){return h(w.prototype,t)}function _(t){return h(_.prototype,t,{createProperty:function(e){var i=(t.createProperty||_.prototype.createProperty).apply(this,arguments);return i.getBaseType&&(i.baseType=i.binary.getType(i.getBaseType(i.binary.contexts[0]))),i}})}return y._getCached=function(t,e,i){return t.hasOwnProperty(this.cacheKey)?t[this.cacheKey]:(e=e.call(this,t),d(t,this.cacheKey,{value:e},i),e)},y.getContext=function(t){switch(typeof t){case"undefined":t=0;case"number":return this.contexts[t];case"string":return this.getContext((function(e){return t in e}));case"function":for(var e=0,i=this.contexts.length;e<i;e++){var n=this.contexts[e];if(t.call(this,n))return n}}},y.inContext=function(t,e){return this.contexts.unshift(t),e=e.call(this),this.contexts.shift(),e},w.prototype={inherit:function(t,e){var i,n=this;function r(t,e){var r=n[t];r&&(i=i||h(n),e.call(i,r),i[t]=null)}return r("params",(function(e){for(var i=0,n=e.length;i<n;i++)this[e[i]]=t[i]})),r("setParams",(function(e){e.apply(this,t)})),r("typeParams",(function(t){for(var i=0,n=t.length;i<n;i++){var r=t[i],s=this[r];s&&(this[r]=e(s))}})),r("resolve",(function(t){t.call(this,e)})),i||n},createProperty:function(t){return h(this,{binary:t,view:t.view})},toValue:function(t,e){return!1!==e&&"string"==typeof t?this.binary.getContext(t)[t]:f(this,this.binary,t)}},_.prototype=h((c.Type=w).prototype,{setParams:function(){this.baseType&&(this.typeParams=["baseType"].concat(this.typeParams||[]))},baseRead:function(){return this.binary.read(this.baseType)},baseWrite:function(t){return this.binary.write(this.baseType,t)}}),o(_.prototype,{read:_.prototype.baseRead,write:_.prototype.baseWrite}),c.Template=_,y.as=function(t,e){return(e=e?this:h(this)).typeSet=(t=t||p)===p||p.isPrototypeOf(t)?t:h(p,t),e.cacheKey=b,e.cacheKey=e._getCached(t,(function(){return b+"."+ ++v}),!0),e},y.seek=function(t,e){if(t=this.toValue(t),void 0===e)return this.view.seek(t);var i=this.view.tell();return this.view.seek(t),e=e.call(this),this.view.seek(i),e},y.tell=function(){return this.view.tell()},y.skip=function(t,e){return this.seek(this.tell()+this.toValue(t),e)},y.slice=function(t,e,i){return new c(this.view.slice(t,e,i),this.typeSet)},y._getType=function(t,e){switch(typeof t){case"string":if(!(t in this.typeSet))throw new ReferenceError("Unknown type: "+t);return this._getType(this.typeSet[t],e);case"number":return this._getType(p.bitfield,[t]);case"object":if(a(t,w)){var i=this;return t.inherit(e||[],(function(t){return i.getType(t)}))}return a(t,Array)?this._getCached(t,(function(t){return this.getType(t[0],t.slice(1))}),!0):this._getCached(t,(function(t){return this.getType(p.object,[t])}),!1)}},y.getType=function(t,e){return(e=this._getType(t,e))&&!a(t,w)&&(e.name="object"==typeof t?a(t,Array)?t[0]+"("+t.slice(1).join(", ")+")":"object":String(t)),e},y._action=function(t,e,i){if(void 0!==t){t=this.getType(t);var n=this._named((function(){return i.call(this,t.createProperty(this),this.contexts[0])}),"["+t.name+"]",e);return void 0!==e?this.seek(e,n):n.call(this)}},y.read=function(t,e){return this._action(t,e,(function(t,e){return t.read(e)}))},y.readAll=function(){return this.read("jBinary.all",0)},y.write=function(t,e,i){return this._action(t,i,(function(t,i){var n=this.tell();return t.write(e,i),this.tell()-n}))},y.writeAll=function(t){return this.write("jBinary.all",t,0)},function(t,e){for(var i=0,n=e.length;i<n;i++){var r=e[i];p[r.toLowerCase()]=h(t,{dataType:r})}}(w({params:["littleEndian"],read:function(){return this.view["get"+this.dataType](void 0,this.littleEndian)},write:function(t){this.view["write"+this.dataType](t,this.littleEndian)}}),["Uint8","Uint16","Uint32","Uint64","Int8","Int16","Int32","Int64","Float32","Float64","Char"]),o(p,{byte:p.uint8,float:p.float32,double:p.float64}),p.array=_({params:["baseType","length"],read:function(){var t=this.toValue(this.length);if(this.baseType===p.uint8)return this.view.getBytes(t,void 0,!0,!0);if(void 0!==t)for(var e=new Array(t),i=0;i<t;i++)e[i]=this.baseRead();else{var n=this.view.byteLength;for(e=[];this.binary.tell()<n;)e.push(this.baseRead())}return e},write:function(t){if(this.baseType===p.uint8)return this.view.writeBytes(t);for(var e=0,i=t.length;e<i;e++)this.baseWrite(t[e])}}),p.binary=_({params:["length","typeSet"],read:function(){var t=this.binary.tell(),e=this.binary.skip(this.toValue(this.length));return new c(this.view.slice(t,e),this.typeSet)},write:function(t){this.binary.write("blob",t.read("blob",0))}}),p.bitfield=w({params:["bitSize"],read:function(){return this.view.getUnsigned(this.bitSize)},write:function(t){this.view.writeUnsigned(t,this.bitSize)}}),p.blob=w({params:["length"],read:function(){return this.view.getBytes(this.toValue(this.length))},write:function(t){this.view.writeBytes(t,!0)}}),p.const=_({params:["baseType","value","strict"],read:function(){var t=this.baseRead();if(this.strict&&t!==this.value){if(a(this.strict,Function))return this.strict(t);throw new TypeError("Unexpected value ("+t+" !== "+this.value+").")}return t},write:function(t){this.baseWrite(this.strict||void 0===t?this.value:t)}}),p.enum=_({params:["baseType","matches"],setParams:function(t,e){for(var i in this.backMatches={},e)this.backMatches[e[i]]=i},read:function(){var t=this.baseRead();return t in this.matches?this.matches[t]:t},write:function(t){this.baseWrite(t in this.backMatches?this.backMatches[t]:t)}}),p.extend=w({setParams:function(){this.parts=arguments},resolve:function(t){for(var e=this.parts,i=e.length,n=new Array(i),r=0;r<i;r++)n[r]=t(e[r]);this.parts=n},read:function(){var t=this.parts,e=this.binary.read(t[0]);return this.binary.inContext(e,(function(){for(var i=1,n=t.length;i<n;i++)o(e,this.read(t[i]))})),e},write:function(t){var e=this.parts;this.binary.inContext(t,(function(){for(var i=0,n=e.length;i<n;i++)this.write(e[i],t)}))}}),p.if=_({params:["condition","trueType","falseType"],typeParams:["trueType","falseType"],getBaseType:function(t){return this.toValue(this.condition)?this.trueType:this.falseType}}),p.if_not=p.ifNot=_({setParams:function(t,e,i){this.baseType=["if",t,i,e]}}),p.lazy=_({marker:"jBinary.Lazy",params:["innerType","length"],getBaseType:function(){return["binary",this.length,this.binary.typeSet]},read:function(){var t=function(e){return 0===arguments.length?"value"in t?t.value:t.value=t.binary.read(t.innerType):o(t,{wasChanged:!0,value:e}).value};return t[this.marker]=!0,o(t,{binary:o(this.baseRead(),{contexts:this.binary.contexts.slice()}),innerType:this.innerType})},write:function(t){t.wasChanged||!t[this.marker]?this.binary.write(this.innerType,t()):this.baseWrite(t.binary)}}),p.object=w({params:["structure","proto"],resolve:function(t){var e,i={};for(e in this.structure)i[e]=a(this.structure[e],Function)?this.structure[e]:t(this.structure[e]);this.structure=i},read:function(){var t=this,e=this.structure,i=this.proto?h(this.proto):{};return this.binary.inContext(i,(function(){for(var n in e)this._named((function(){var r=a(e[n],Function)?e[n].call(t,i):this.read(e[n]);void 0!==r&&(i[n]=r)}),n).call(this)})),i},write:function(t){var e=this,i=this.structure;this.binary.inContext(t,(function(){for(var n in i)this._named((function(){a(i[n],Function)?t[n]=i[n].call(e,t):this.write(i[n],t[n])}),n).call(this)}))}}),p.skip=w({params:["length"],read:function(){this.view.skip(this.toValue(this.length))},write:function(){this.read()}}),p.string=_({params:["length","encoding"],read:function(){return this.view.getString(this.toValue(this.length),void 0,this.encoding)},write:function(t){this.view.writeString(t,this.encoding)}}),p.string0=w({params:["length","encoding"],read:function(){var t=this.view;if(void 0!==(n=this.length))return t.getString(n,void 0,this.encoding).replace(/\0.*$/,"");for(var e=t.tell(),i=0,n=t.byteLength-e;i<n&&t.getUint8();)i++;return e=t.getString(i,e,this.encoding),i<n&&t.skip(1),e},write:function(t){var e=this.view,i=void 0===this.length?1:this.length-t.length;e.writeString(t,void 0,this.encoding),0<i&&(e.writeUint8(0),e.skip(i-1))}}),c.loadData=u((function(e,i){var n;if(a(e,t.Blob))if("FileReader"in t)(o=new FileReader).onload=o.onerror=function(){i(this.error,this.result)},o.readAsArrayBuffer(e);else{var r,s,o=new FileReaderSync;try{s=o.readAsArrayBuffer(e)}catch(e){r=e}finally{i(r,s)}}else if("string"!=typeof e)i(new TypeError("Unsupported source type."));else if(s=e.match(/^data:(.+?)(;base64)?,(.*)$/))try{var h=s[2],f=s[3];i(null,(h?atob:decodeURIComponent)(f))}catch(e){i(e)}else"XMLHttpRequest"in t?((f=new XMLHttpRequest).open("GET",e,!0),"responseType"in f?f.responseType="arraybuffer":"overrideMimeType"in f?f.overrideMimeType("text/plain; charset=x-user-defined"):f.setRequestHeader("Accept-Charset","x-user-defined"),"onload"in f||(f.onreadystatechange=function(){4===this.readyState&&this.onload()}),n=function(t){i(new Error(t))},f.onload=function(){if(0!==this.status&&200!==this.status)return n("HTTP Error #"+this.status+": "+this.statusText);"response"in this||(this.response=new VBArray(this.responseBody).toArray()),i(null,this.response)},f.onerror=function(){n("Network error.")},f.send(null)):i(new TypeError("Unsupported source type."))})),(c.load=u((function(t,e,i){var n=c.loadData(t);c.load.getTypeSet(t,e,(function(t){n.then((function(e){i(null,new c(e,t))}),i)}))}))).getTypeSet=function(t,e,i){i(e)},y._toURI="URL"in t&&"createObjectURL"in URL?function(t){var e=this.seek(0,(function(){return this.view.getBytes()}));return URL.createObjectURL(new Blob([e],{type:t}))}:function(t){var e=this.seek(0,(function(){return this.view.getString(void 0,void 0,"binary")}));return"data:"+t+";base64,"+btoa(e)},y._mimeType=function(t){return t||this.typeSet["jBinary.mimeType"]||"application/octet-stream"},y.toURI=function(t){return this._toURI(this._mimeType(t))},r&&((g=c.downloader=r.createElement("a")).style.display="none"),y.saveAs=u((function(t,e,i){"string"==typeof t?("msSaveBlob"in navigator?navigator.msSaveBlob(new Blob([this.read("blob",0)],{type:this._mimeType(e)}),t):r?(g.parentNode||r.body.appendChild(g),g.href=this.toURI(e),g.download=t,g.click(),g.href=g.download=""):i(new TypeError("Saving from Web Worker is not supported.")),i()):i(new TypeError("Unsupported storage type."))})),c}(this,i(628))}()},628:t=>{!function(e){t.exports=function(t){"use strict";function e(t,e){return"object"==typeof t&&null!==t&&(t.constructor===e||Object.prototype.toString.call(t)==="[object "+e.name+"]")}function i(t,i){return!i&&e(t,Array)?t:Array.prototype.slice.call(t)}function n(t,e){return void 0!==t?t:e}function r(t,i,s,a){if(r.is(t)){var o=t.slice(i,i+s);return o._littleEndian=n(a,o._littleEndian),o}if(!r.is(this))return new r(t,i,s,a);if(this.buffer=t=r.wrapBuffer(t),this._isArrayBuffer=f.ArrayBuffer&&e(t,ArrayBuffer),this._isPixelData=!1,this._isDataView=f.DataView&&this._isArrayBuffer,this._isNodeBuffer=f.NodeBuffer&&e(t,Buffer),!this._isNodeBuffer&&!this._isArrayBuffer&&!e(t,Array))throw new TypeError("jDataView buffer has an incompatible type");this._littleEndian=!!a;var h="byteLength"in t?t.byteLength:t.length;this.byteOffset=i=n(i,0),this.byteLength=s=n(s,h-i),this._offset=this._bitOffset=0,this._isDataView?this._view=new DataView(t,i,s):this._checkBounds(i,s,h),this._engineAction=this._isDataView?this._dataViewAction:this._isNodeBuffer?this._nodeBufferAction:this._isArrayBuffer?this._arrayBufferAction:this._arrayAction}function s(t){if(f.NodeBuffer)return new Buffer(t,"binary");for(var e=new(f.ArrayBuffer?Uint8Array:Array)(t.length),i=0,n=t.length;n>i;i++)e[i]=255&t.charCodeAt(i);return e}function a(t){return t>=0&&31>t?1<<t:a[t]||(a[t]=Math.pow(2,t))}function o(t,e){this.lo=t,this.hi=e}function h(){o.apply(this,arguments)}var f={NodeBuffer:"Buffer"in t,DataView:"DataView"in t,ArrayBuffer:"ArrayBuffer"in t,PixelData:!1},u=t.TextEncoder,c=t.TextDecoder;f.NodeBuffer&&function(t){try{t.writeFloatLE(1/0,0)}catch(t){f.NodeBuffer=!1}}(new Buffer(4));var l={Int8:1,Int16:2,Int32:4,Uint8:1,Uint16:2,Uint32:4,Float32:4,Float64:8};r.wrapBuffer=function(t){switch(typeof t){case"number":if(f.NodeBuffer)(t=new Buffer(t)).fill(0);else if(f.ArrayBuffer)t=new Uint8Array(t).buffer;else{t=new Array(t);for(var n=0;n<t.length;n++)t[n]=0}return t;case"string":t=s(t);default:return"length"in t&&!(f.NodeBuffer&&e(t,Buffer)||f.ArrayBuffer&&e(t,ArrayBuffer))&&(f.NodeBuffer?t=new Buffer(t):f.ArrayBuffer?e(t,ArrayBuffer)||e(t=new Uint8Array(t).buffer,ArrayBuffer)||(t=new Uint8Array(i(t,!0)).buffer):t=i(t)),t}},r.is=function(t){return t&&t.jDataView},r.from=function(){return new r(arguments)},r.Uint64=o,o.prototype={valueOf:function(){return this.lo+a(32)*this.hi},toString:function(){return Number.prototype.toString.apply(this.valueOf(),arguments)}},o.fromNumber=function(t){var e=Math.floor(t/a(32));return new o(t-e*a(32),e)},r.Int64=h,h.prototype="create"in Object?Object.create(o.prototype):new o,h.prototype.valueOf=function(){return this.hi<a(31)?o.prototype.valueOf.apply(this,arguments):-(a(32)-this.lo+a(32)*(a(32)-1-this.hi))},h.fromNumber=function(t){var e,i;if(t>=0){var n=o.fromNumber(t);e=n.lo,i=n.hi}else e=t-(i=Math.floor(t/a(32)))*a(32),i+=a(32);return new h(e,i)};var y=r.prototype={compatibility:f,jDataView:!0,_checkBounds:function(t,e,i){if("number"!=typeof t)throw new TypeError("Offset is not a number.");if("number"!=typeof e)throw new TypeError("Size is not a number.");if(0>e)throw new RangeError("Length is negative.");if(0>t||t+e>n(i,this.byteLength))throw new RangeError("Offsets are out of bounds.")},_action:function(t,e,i,r,s){return this._engineAction(t,e,n(i,this._offset),n(r,this._littleEndian),s)},_dataViewAction:function(t,e,i,n,r){return this._offset=i+l[t],e?this._view["get"+t](i,n):this._view["set"+t](i,r,n)},_arrayBufferAction:function(e,i,r,s,a){var o,h=l[e],f=t[e+"Array"];if(s=n(s,this._littleEndian),1===h||(this.byteOffset+r)%h==0&&s)return o=new f(this.buffer,this.byteOffset+r,1),this._offset=r+h,i?o[0]:o[0]=a;var u=new Uint8Array(i?this.getBytes(h,r,s,!0):h);return o=new f(u.buffer,0,1),i?o[0]:(o[0]=a,void this._setBytes(r,u,s))},_arrayAction:function(t,e,i,n,r){return e?this["_get"+t](i,n):this["_set"+t](i,r,n)},_getBytes:function(t,e,r){r=n(r,this._littleEndian),e=n(e,this._offset),t=n(t,this.byteLength-e),this._checkBounds(e,t),e+=this.byteOffset,this._offset=e-this.byteOffset+t;var s=this._isArrayBuffer?new Uint8Array(this.buffer,e,t):(this.buffer.slice||Array.prototype.slice).call(this.buffer,e,e+t);return r||1>=t?s:i(s).reverse()},getBytes:function(t,e,r,s){var a=this._getBytes(t,e,n(r,!0));return s?i(a):a},_setBytes:function(t,e,r){var s=e.length;if(0!==s){if(r=n(r,this._littleEndian),t=n(t,this._offset),this._checkBounds(t,s),!r&&s>1&&(e=i(e,!0).reverse()),t+=this.byteOffset,this._isArrayBuffer)new Uint8Array(this.buffer,t,s).set(e);else if(this._isNodeBuffer)new Buffer(e).copy(this.buffer,t);else for(var a=0;s>a;a++)this.buffer[t+a]=e[a];this._offset=t-this.byteOffset+s}},setBytes:function(t,e,i){this._setBytes(t,e,n(i,!0))},getString:function(t,e,i){if(this._isNodeBuffer)return e=n(e,this._offset),t=n(t,this.byteLength-e),this._checkBounds(e,t),this._offset=e+t,this.buffer.toString(i||"binary",this.byteOffset+e,this.byteOffset+this._offset);var r=this._getBytes(t,e,!0);if(i="utf8"===i?"utf-8":i||"binary",c&&"binary"!==i)return new c(i).decode(this._isArrayBuffer?r:new Uint8Array(r));var s="";t=r.length;for(var a=0;t>a;a++)s+=String.fromCharCode(r[a]);return"utf-8"===i&&(s=decodeURIComponent(escape(s))),s},setString:function(t,e,i){if(this._isNodeBuffer)return t=n(t,this._offset),this._checkBounds(t,e.length),void(this._offset=t+this.buffer.write(e,this.byteOffset+t,i||"binary"));var r;i="utf8"===i?"utf-8":i||"binary",u&&"binary"!==i?r=new u(i).encode(e):("utf-8"===i&&(e=unescape(encodeURIComponent(e))),r=s(e)),this._setBytes(t,r,!0)},getChar:function(t){return this.getString(1,t)},setChar:function(t,e){this.setString(t,e)},tell:function(){return this._offset},seek:function(t){return this._checkBounds(t,0),this._offset=t},skip:function(t){return this.seek(this._offset+t)},slice:function(t,e,i){function s(t,e){return 0>t?t+e:t}return t=s(t,this.byteLength),e=s(n(e,this.byteLength),this.byteLength),i?new r(this.getBytes(e-t,t,!0,!0),void 0,void 0,this._littleEndian):new r(this.buffer,this.byteOffset+t,e-t,this._littleEndian)},alignBy:function(t){return this._bitOffset=0,1!==n(t,1)?this.skip(t-(this._offset%t||t)):this._offset},_getFloat64:function(t,e){var i=this._getBytes(8,t,e),n=1-2*(i[7]>>7),r=((i[7]<<1&255)<<3|i[6]>>4)-1023,s=(15&i[6])*a(48)+i[5]*a(40)+i[4]*a(32)+i[3]*a(24)+i[2]*a(16)+i[1]*a(8)+i[0];return 1024===r?0!==s?NaN:1/0*n:-1023===r?n*s*a(-1074):n*(1+s*a(-52))*a(r)},_getFloat32:function(t,e){var i=this._getBytes(4,t,e),n=1-2*(i[3]>>7),r=(i[3]<<1&255|i[2]>>7)-127,s=(127&i[2])<<16|i[1]<<8|i[0];return 128===r?0!==s?NaN:1/0*n:-127===r?n*s*a(-149):n*(1+s*a(-23))*a(r)},_get64:function(t,e,i){i=n(i,this._littleEndian),e=n(e,this._offset);for(var r=i?[0,4]:[4,0],s=0;2>s;s++)r[s]=this.getUint32(e+r[s],i);return this._offset=e+8,new t(r[0],r[1])},getInt64:function(t,e){return this._get64(h,t,e)},getUint64:function(t,e){return this._get64(o,t,e)},_getInt32:function(t,e){var i=this._getBytes(4,t,e);return i[3]<<24|i[2]<<16|i[1]<<8|i[0]},_getUint32:function(t,e){return this._getInt32(t,e)>>>0},_getInt16:function(t,e){return this._getUint16(t,e)<<16>>16},_getUint16:function(t,e){var i=this._getBytes(2,t,e);return i[1]<<8|i[0]},_getInt8:function(t){return this._getUint8(t)<<24>>24},_getUint8:function(t){return this._getBytes(1,t)[0]},_getBitRangeData:function(t,e){var i=(n(e,this._offset)<<3)+this._bitOffset,r=i+t,s=i>>>3,a=r+7>>>3,o=this._getBytes(a-s,s,!0),h=0;(this._bitOffset=7&r)&&(this._bitOffset-=8);for(var f=0,u=o.length;u>f;f++)h=h<<8|o[f];return{start:s,bytes:o,wideValue:h}},getSigned:function(t,e){var i=32-t;return this.getUnsigned(t,e)<<i>>i},getUnsigned:function(t,e){var i=this._getBitRangeData(t,e).wideValue>>>-this._bitOffset;return 32>t?i&~(-1<<t):i},_setBinaryFloat:function(t,e,i,n,r){var s,o,h=0>e?1:0,f=~(-1<<n-1),u=1-f;0>e&&(e=-e),0===e?(s=0,o=0):isNaN(e)?(s=2*f+1,o=1):1/0===e?(s=2*f+1,o=0):(s=Math.floor(Math.log(e)/Math.LN2))>=u&&f>=s?(o=Math.floor((e*a(-s)-1)*a(i)),s+=f):(o=Math.floor(e/a(u-i)),s=0);for(var c=[];i>=8;)c.push(o%256),o=Math.floor(o/256),i-=8;for(s=s<<i|o,n+=i;n>=8;)c.push(255&s),s>>>=8,n-=8;c.push(h<<n|s),this._setBytes(t,c,r)},_setFloat32:function(t,e,i){this._setBinaryFloat(t,e,23,8,i)},_setFloat64:function(t,e,i){this._setBinaryFloat(t,e,52,11,i)},_set64:function(t,e,i,r){"object"!=typeof i&&(i=t.fromNumber(i)),r=n(r,this._littleEndian),e=n(e,this._offset);var s=r?{lo:0,hi:4}:{lo:4,hi:0};for(var a in s)this.setUint32(e+s[a],i[a],r);this._offset=e+8},setInt64:function(t,e,i){this._set64(h,t,e,i)},setUint64:function(t,e,i){this._set64(o,t,e,i)},_setUint32:function(t,e,i){this._setBytes(t,[255&e,e>>>8&255,e>>>16&255,e>>>24],i)},_setUint16:function(t,e,i){this._setBytes(t,[255&e,e>>>8&255],i)},_setUint8:function(t,e){this._setBytes(t,[255&e])},setUnsigned:function(t,e,i){var n=this._getBitRangeData(i,t),r=n.wideValue,s=n.bytes;r&=~(~(-1<<i)<<-this._bitOffset),r|=(32>i?e&~(-1<<i):e)<<-this._bitOffset;for(var a=s.length-1;a>=0;a--)s[a]=255&r,r>>>=8;this._setBytes(n.start,s,!0)}},p={Int8:"Int8",Int16:"Int16",Int32:"Int32",Uint8:"UInt8",Uint16:"UInt16",Uint32:"UInt32",Float32:"Float",Float64:"Double"};for(var d in y._nodeBufferAction=function(t,e,i,n,r){this._offset=i+l[t];var s=p[t]+("Int8"===t||"Uint8"===t?"":n?"LE":"BE");return i+=this.byteOffset,e?this.buffer["read"+s](i):this.buffer["write"+s](r,i)},l)!function(t){y["get"+t]=function(e,i){return this._action(t,!0,e,i)},y["set"+t]=function(e,i,n){this._action(t,!1,e,n,i)}}(d);for(var g in y._setInt32=y._setUint32,y._setInt16=y._setUint16,y._setInt8=y._setUint8,y.setSigned=y.setUnsigned,y)"set"===g.slice(0,3)&&function(t){y["write"+t]=function(){Array.prototype.unshift.call(arguments,void 0),this["set"+t].apply(this,arguments)}}(g.slice(3));return r}(this)}()}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var s=e[n]={exports:{}};return t[n](s,s.exports,i),s.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};return(()=>{"use strict";i.r(n),i.d(n,{loadBackground:()=>f,loadFileFromFileInput:()=>h,loadSprite:()=>u});var t=i(406),e=i.n(t);i(628);const r=t=>({r:t>>8,g:t>>3,b:t<<3}),s=t=>({r:t>>7,g:t>>2,b:t<<3}),a=class{InitHeader(t,e){this.pixelFormat=e,this.offset=t.read("uint32"),this.width=t.read("uint16"),this.height=t.read("uint16"),this.data=t}SetData(t){this.data=t}Draw(){const t=new ArrayBuffer(this.width*this.height*4),e=new Uint8ClampedArray(t);for(let t=0;t<this.width;t++)for(let i=0;i<this.height;i++){let n,a=this.width*i+t;const o=this.data.read("uint16",4+this.offset+2*a);n=0===this.pixelFormat?s(o):r(o);const{r:h,g:f,b:u}=n;e[4*a]=248&h,e[4*a+1]=248&f,e[4*a+2]=248&u,e[4*a+3]=255}return e}DrawBitmap(){return new ImageData(this.Draw(),this.width,this.height)}},o=class{constructor(t){this.data=new(e())(t,{"jBinary.littleEndian":!0}),this.InitBitmaps()}InitBitmaps(){this.pixelFormat=this.data.read("uint32"),this.tileWidth=this.data.read("uint16"),this.tileHeight=this.data.read("uint16"),this.count=this.data.read("uint16"),console.assert(0===this.pixelFormat||1===this.pixelFormat,"Pixel format is not correct"),this.bitmaps=[];for(let t=0;t<this.count;t++)this.bitmaps.push(new a(this.pixelFormat)),this.bitmaps[t].InitHeader(this.data,this.pixelFormat);for(let t=0;t<this.count;t++)this.bitmaps[t].SetData(this.data)}DrawBitmap(){const t=this.bitmaps[0].width,e=this.bitmaps[0].height,i=this.tileWidth*t,n=this.tileHeight*e,r=new ArrayBuffer(i*n*4),s=new Uint8ClampedArray(r);let a=0,o=0;for(let n=0;n<this.tileHeight;n++){o=a;for(let r=0;r<this.tileWidth;r++){const a=this.bitmaps[o].Draw(),h=r*t*4+n*e*i*4;s[h]=255,s[h+1]=0,s[h+2]=0,s[h+3]=255;let f=h,u=e;for(;u--;){const e=a.slice(u*(4*t),u*t*4+4*t);f+u*i*4<s.length+e.length&&s.set(e,f+u*i*4)}o+=this.tileHeight}a++}return new ImageData(s,i,n)}},h=async t=>{if(void 0!==t.name){if("blk"===t.name.substr(-3)){const i=await e().loadData(t);return new o(i).DrawBitmap()}if("s16"===t.name.substr(-3)){const i=await e().loadData(t);return new a(i).DrawBitmap()}}},f=async t=>{const i=await e().loadData(t);return new o(i).DrawBitmap()},u=async t=>{const i=await e().loadData(t);return new a(i).DrawBitmap()}})(),n})()}));